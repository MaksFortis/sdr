# CRM Lead Service

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π –∏–∑ RabbitMQ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö —Å PostgreSQL. –°–µ—Ä–≤–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ö–µ–º—ã —Ç–∞–±–ª–∏—Ü –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—É—á–∞–µ–º—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  RabbitMQ   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  Lead Service    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  PostgreSQL  ‚îÇ
‚îÇ   Queue     ‚îÇ         ‚îÇ   (Consumer)     ‚îÇ         ‚îÇ   Database   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                ‚îÇ
                                ‚ñº
                        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                        ‚îÇ Auto Schema   ‚îÇ
                        ‚îÇ Management    ‚îÇ
                        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- **Consumer** (`internal/service/consumer_rabbitmq`): –°–ª—É—à–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å RabbitMQ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
- **Schema Service** (`internal/service/schema_database`): –£–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Ö–µ–º–∞–º–∏ —Ç–∞–±–ª–∏—Ü (—Å–æ–∑–¥–∞–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
- **Storage** (`internal/storage/db`): –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ (insert, update)
- **Domain** (`internal/domain`): –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

## üõ†Ô∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Go** 1.21 –∏–ª–∏ –≤—ã—à–µ
- **Docker** –∏ **Docker Compose** (–¥–ª—è –∑–∞–ø—É—Å–∫–∞ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã)
- **PostgreSQL** 15+ (–µ—Å–ª–∏ –∑–∞–ø—É—Å–∫ –±–µ–∑ Docker)
- **RabbitMQ** 3.13+ (–µ—Å–ª–∏ –∑–∞–ø—É—Å–∫ –±–µ–∑ Docker)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ó–∞–ø—É—Å–∫ —Å Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone <repository-url>
cd crm-lead-service
```

2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
```env
# RabbitMQ Configuration
RABBITMQ_USER=root
RABBITMQ_PASSWORD=root
RABBITMQ_QUEUE=white_data

# Database Configuration
DB_HOST=postgres
DB_PORT=5432
DB_USER=app_user
DB_PASSWORD=app_password
DB_NAME=app_db

# Application
PORT=8080
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã:
```bash
docker-compose up -d
```

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:
```bash
docker-compose ps
```

5. –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:
```bash
# –õ–æ–≥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose logs -f

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose logs -f lead-service
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
docker-compose down

# –° —É–¥–∞–ª–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö
docker-compose down -v
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|-----------|----------|----------------------|
| `RABBITMQ_URL` | URL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ RabbitMQ | `amqp://root:root@localhost:5672/` |
| `RABBITMQ_USER` | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è RabbitMQ | `root` |
| `RABBITMQ_PASSWORD` | –ü–∞—Ä–æ–ª—å RabbitMQ | `root` |
| `RABBITMQ_QUEUE` | –ù–∞–∑–≤–∞–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏ –¥–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è | `white_data` |
| `DB_HOST` | –•–æ—Å—Ç PostgreSQL | `localhost` |
| `DB_PORT` | –ü–æ—Ä—Ç PostgreSQL | `5432` |
| `DB_USER` | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î | `app_user` |
| `DB_PASSWORD` | –ü–∞—Ä–æ–ª—å –ë–î | `app_password` |
| `DB_NAME` | –ù–∞–∑–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö | `app_db` |

### –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —á–µ—Ä–µ–∑ Docker Compose:

- **RabbitMQ Management**: http://localhost:15672 (–ª–æ–≥–∏–Ω: `root`, –ø–∞—Ä–æ–ª—å: `root`)
- **PostgreSQL**: `localhost:5432`

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è

1. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è**
   - –°–µ—Ä–≤–∏—Å –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ RabbitMQ –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç —Å–ª—É—à–∞—Ç—å —É–∫–∞–∑–∞–Ω–Ω—É—é –æ—á–µ—Ä–µ–¥—å
   - –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–Ω–æ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç—Å—è –∏–∑ JSON

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ö–µ–º—ã**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π (tableName, columns)
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏—è

3. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º–æ–π –ë–î**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –≤ PostgreSQL
   - –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã –Ω–µ—Ç - —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è —Å –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Å—Ö–µ–º–æ–π
   - –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è —Å—Ö–µ–º—ã
   - –ù–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
   - **INSERT**: –í—Å—Ç–∞–≤–∫–∞ –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏ —Å `ON CONFLICT DO NOTHING`
   - **UPDATE**: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –ø–æ –ø–µ—Ä–≤–∏—á–Ω–æ–º—É –∫–ª—é—á—É, –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ - –≤—Å—Ç–∞–≤–∫–∞ –Ω–æ–≤–æ–π

5. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏**
   - –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ: `Ack` - —Å–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ –æ—á–µ—Ä–µ–¥–∏
   - –ü—Ä–∏ –æ—à–∏–±–∫–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏: `Nack` (—Å requeue) - —Å–æ–æ–±—â–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å
   - –ü—Ä–∏ –æ—à–∏–±–∫–µ –ë–î: `Nack` (—Å requeue) - —Å–æ–æ–±—â–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- **–û—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞**: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è –±–µ–∑ –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –æ—á–µ—Ä–µ–¥—å
- **–ù–µ–≤–∞–ª–∏–¥–Ω–∞—è —Å—Ö–µ–º–∞**: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è –±–µ–∑ –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –æ—á–µ—Ä–µ–¥—å
- **–û—à–∏–±–∫–∏ –ë–î**: –°–æ–æ–±—â–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **Graceful Shutdown**: –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ SIGINT/SIGTERM —Å–µ—Ä–≤–∏—Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É

## –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è

```json
{
  "event_type": "insert",
  "schema": {
    "tableName": "users",
    "columns": {
      "id": {
        "name": "id",
        "type": "integer",
        "dbType": "integer",
        "phpType": "integer",
        "allowNull": false,
        "isPrimaryKey": true,
        "autoIncrement": true
      },
      "email": {
        "name": "email",
        "type": "string",
        "dbType": "varchar",
        "phpType": "string",
        "allowNull": false,
        "size": 255
      },
      "created_at": {
        "name": "created_at",
        "type": "timestamp",
        "dbType": "timestamp",
        "phpType": "string",
        "allowNull": true
      }
    },
    "primaryKey": ["id"]
  },
  "data": [
    {
      "field": "id",
      "new_value": 123
    },
    {
      "field": "email",
      "new_value": "user@example.com"
    },
    {
      "field": "created_at",
      "new_value": "2024-12-02T10:00:00Z"
    }
  ]
}
```

### –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π

- `insert` - –≤—Å—Ç–∞–≤–∫–∞ –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏
- `update` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∑–∞–ø–∏—Å–∏

### –ü—Ä–∏–º–µ—Ä UPDATE —Å–æ–±—ã—Ç–∏—è

```json
{
  "event_type": "update",
  "schema": {
    "tableName": "users",
    "columns": { ... },
    "primaryKey": ["id"]
  },
  "data": [
    {
      "field": "id",
      "new_value": 123
    },
    {
      "field": "email",
      "old_value": "old@example.com",
      "new_value": "new@example.com"
    }
  ]
}
```

## üíª –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ó–∞–ø—É—Å–∫ –±–µ–∑ Docker

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
go mod download
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ PostgreSQL –∏ RabbitMQ –ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã —á–µ—Ä–µ–∑ Docker:
```bash
# –¢–æ–ª—å–∫–æ PostgreSQL –∏ RabbitMQ
docker-compose up -d postgres rabbitmq
```

3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
export RABBITMQ_URL="amqp://root:root@localhost:5672/"
export RABBITMQ_USER="root"
export RABBITMQ_PASSWORD="root"
export RABBITMQ_QUEUE="white_data"
export DB_HOST="localhost"
export DB_PORT="5432"
export DB_USER="app_user"
export DB_PASSWORD="app_password"
export DB_NAME="app_db"
```

4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
go run main.go
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ RabbitMQ

–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å RabbitMQ Management –∏–ª–∏ CLI:

```bash
# –ß–µ—Ä–µ–∑ Management UI
# 1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:15672
# 2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Queues ‚Üí white_data
# 3. Publish message
# 4. –í—Å—Ç–∞–≤—å—Ç–µ JSON –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ –≤—ã—à–µ
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
crm-lead-service/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ app/              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ       ‚îî‚îÄ‚îÄ app.go
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ domain/           # –î–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ message.go
‚îÇ   ‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ consumer_rabbitmq/  # –ö–æ–Ω—Å—å—é–º–µ—Ä RabbitMQ
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ consumer.go
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schema_database/    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º–∞–º–∏ –ë–î
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ schema.go
‚îÇ   ‚îî‚îÄ‚îÄ storage/
‚îÇ       ‚îî‚îÄ‚îÄ db/           # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ           ‚îî‚îÄ‚îÄ pgsql.go
‚îú‚îÄ‚îÄ pkg/
‚îÇ   ‚îú‚îÄ‚îÄ database/         # –ö–ª–∏–µ–Ω—Ç PostgreSQL
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pgsql.go
‚îÇ   ‚îî‚îÄ‚îÄ rabbitmq/         # –ö–ª–∏–µ–Ω—Ç RabbitMQ
‚îÇ       ‚îî‚îÄ‚îÄ rabbitmq.go
‚îú‚îÄ‚îÄ docker-compose.yml    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker Compose
‚îú‚îÄ‚îÄ Dockerfile            # Dockerfile –¥–ª—è —Å–±–æ—Ä–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ go.mod
‚îú‚îÄ‚îÄ go.sum
‚îî‚îÄ‚îÄ main.go              # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

–°–µ—Ä–≤–∏—Å –≤—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –æ —Å–≤–æ–µ–π —Ä–∞–±–æ—Ç–µ:

```
2024/12/02 10:00:00 Waiting for messages in queue: white_data
2024/12/02 10:00:01 Received a message from queue: white_data
2024/12/02 10:00:01 Processing message: EventType=insert, Table=users, Fields=3
2024/12/02 10:00:01 Successfully processed message: Table=users, EventType=insert
```

### –¢–∏–ø—ã –ª–æ–≥–æ–≤

- **Info**: –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å–µ—Ä–≤–∏—Å–∞
- **Error**: –û—à–∏–±–∫–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ (—Å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç—è–º–∏)
- **Fatal**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏, –ø—Ä–∏–≤–æ–¥—è—â–∏–µ –∫ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ —Å–µ—Ä–≤–∏—Å–∞
